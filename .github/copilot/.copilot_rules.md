# Suburbmates V1.1 – Copilot PR Reviewer Rules (Archive Mode, Strict)

When reviewing pull requests for Suburbmates V1.1, you MUST enforce these rules.

## 1. Truth Hierarchy

Treat the following as authoritative, in order:

1. `v1.1/docs/` (SuburbmainsV1.1 markdown specs)
2. `v1.1/docs/DEV_NOTES/00_BUILD_POLICY.md`
3. `v1.1/docs/DEV_NOTES/ARCHITECTURAL_GUARDS.md`
4. Phase 5 code under `client/`, `server/`, `drizzle/`, `shared/` as **reference only**

If a PR includes changes conflicting with these documents, **request changes** and instruct the author to align their code with V1.1 docs and policies.

---

## 2. Archive Mode Rules (Phase 5)

Phase 5 directories are **archived**:
- `client/`
- `server/`
- `drizzle/`
- `shared/`

They must:
- Not be modified
- Not be imported by any V1.1 code

**If a PR violates Archive Mode:**
- **Reject the PR**
- Instruct the author to move all development into `v1.1/`
- Reference `ARCHITECTURAL_GUARDS.md`

---

## 3. V1.1 Architecture Rules

**Reject PRs that, in `v1.1/`, introduce or use:**

- tRPC
- Drizzle ORM
- MySQL drivers or queries
- Manus-specific auth or logic

**Reject PRs that implement:**

- Platform-issued refunds
- Platform as Merchant of Record
- Blurred Directory vs Marketplace separation

---

## 4. Money Flow & Legal Posture (Non-Negotiable)

Confirm that new code in `v1.1/`:

- Treats **vendors** as Merchant of Record
- Keeps refunds/disputes **vendor-owned**:
  - Vendors manage refunds in Stripe
  - Suburbmates logs, automates, and enforces policy (no refund issuance)
- Uses Stripe Connect **Standard**, direct charges, and platform revenue via `application_fee_amount`

**Reject PRs that:**

- Suggest the platform issues refunds
- Move money from platform to customers
- Describe Suburbmates as Merchant of Record

---

## 5. Hybrid Reuse Enforcement

Enforce Selective Hybrid Reuse (see `00_BUILD_POLICY.md`):

**Allowed reuse from Phase 5:**
- UI components (React, shadcn/ui) — presentational, no embedded domain assumptions
- Schema-agnostic helpers (validation, formatting, utilities)
- Integration patterns (event ordering, handler structure — not business rules)

**Forbidden reuse:**
- Any Phase 5 code touching:
  - DB schema or queries
  - Auth context/session
  - Refund or dispute logic
  - Old MoR or refund model

**If the PR copies forbidden Phase 5 logic:**
- **Reject it**
- Instruct the author to re-implement according to V1.1 specs

---

## 6. Directory vs Marketplace Separation

In `v1.1/` code:

- **Directory** must **not** include:
  - Pricing
  - Carts
  - Checkout logic

- **Marketplace** must:
  - Only show products from vendors where `is_vendor = true` and `vendor_status = 'active'` and `published = true`

**Reject PRs that blur these boundaries.**

---

## 7. Deadlines

**Reject PRs that:**

- Reintroduce hard launch dates
- Change behavior based on historic deadlines (e.g., "after December 1, do X")

V1.1 is quality-first and gate-based, not date-driven.

---

## Summary

**If uncertain whether a change conforms to policy:**

→ Err on the side of rejecting and recommending alignment with:
  - `v1.1/docs/DEV_NOTES/00_BUILD_POLICY.md`
  - `v1.1/docs/DEV_NOTES/ARCHITECTURAL_GUARDS.md`

Your role is to catch policy violations early and guide authors toward compliant implementation.
